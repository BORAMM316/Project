<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

<!-- css -->
<link rel="stylesheet" href="resources/css/simTree.css">
<link rel="stylesheet" href="resources/css/common.css">
<link rel="stylesheet" href="resources/css/popup.css">
<link rel="stylesheet" href="resources/css/popup.css">

<!-- js -->
<script src="resources/js/jquery-3.3.1.min.js"></script>
<script src="resources/js/jquery-migrate-3.3.0.min.js"></script>
<script src="resources/js/simTree.js"></script>

<title>TM QA 대상 지정 || 푸본현대생명</title>
</head>
<body>
<!-- #wrap -->
<div id="wrap">
    <!-- #container -->
    <div id="container">
        <!-- #contents -->
        <div class="popup_wrap">
            <h1>QA 대상 지정</h1>

            <!-- .target_setArea -->
            <div class="target_setArea">
                <!-- [D] QA 대상 지정의 총 건수는 저장된 이후에 반영되어야함 -->
                <h2>
                    QA 대상 지정
                    <span>총 <em class="qa_total_case"></em>건</span>
                </h2>

                <div class="fl">
                    <dl class="set_condition">
                        <dt>
                            <div class="iptBox">
                                <label for="">TMR 지정</label>
                                <input type="text" numberOnly>
                                <em>건</em>
                            </div>
                        </dt>

                        <dd>
                            <div class="sltArea slt_before fl">
                                <div id="tmrAssign"></div>
                            </div>

                            <div class="btnBox">
                                <a href="#none" class="btn_move_right">
                                    <span>선택완료이동</span>
                                </a>
                                <a href="#none" class="btn_move_left">
                                    <span>선택가능이동</span>
                                </a>
                            </div>

                            <div class="sltArea slt_after fr">

                            </div>
                        </dd>
                    </dl>

                    <dl class="set_condition">
                        <dt>
                            <div class="iptBox">
                                <label for="">TA 점수</label>
                                <input type="text" numberOnly>
                                <em>건</em>
                            </div>
                        </dt>

                        <dd>

                        </dd>
                    </dl>
                </div>

                <div class="fr">
                    <dl class="set_condition">
                        <dt>
                            <div class="iptBox">
                                <label for="">TA 부분&sol;미탐지 구간</label>
                                <input type="text" numberOnly>
                                <em>건</em>
                            </div>
                        </dt>

                        <dd>
                            <div class="sltArea slt_before fl">
                                <div id="ta"></div>
                            </div>

                            <div class="btnBox">
                                <a href="#none" class="btn_move_right">
                                    <span>선택완료이동</span>
                                </a>
                                <a href="#none" class="btn_move_left">
                                    <span>선택가능이동</span>
                                </a>
                            </div>

                            <div class="sltArea slt_after fr">
                                
                            </div>
                        </dd>
                    </dl>

                    <dl class="set_condition">
                        <dt>
                            <div class="iptBox">
                                <label for="">상품명</label>
                                <input type="text" numberOnly>
                                <em>건</em>
                            </div>
                        </dt>

                        <dd>
                            <div class="sltArea">
                                
                            </div>
                        </dd>
                    </dl>
                </div>
                
                <div class="btnBox">
                    <a href="#lyr_qaTarget_save" class="btn_save btn_lyr_open">저장</a>
                </div>
            </div>
            <!-- //.target_setArea -->
        </div>
        <!-- //#contents -->
    </div>
    <!-- //#container -->
</div>
<!-- //#wrap -->

<!-- layer popup -->
<!-- QA 대상 지정상태 저장 -->
<div id="lyr_qaTarget_save" class="lyrBox">
    <div class="lyr_hd">
        <span class="title">QA 대상 지정상태 저장</span>
        <a href="#none" class="btn_lyr_close">닫기</a>
     </div>
    <div class="lyr_ct">
            <p>저장 내용의 반영은 기존결과에 영향을 끼치지 않으며,<br>
            이후 &lbrack;대상 지정&rbrack; 자동화 처리 시 반영됩니다.</p>
    </div>
    <div class="lyr_ft">
        <div class="btnBox">
            <a href="#none" class="btn_lyr_save">확인</a>
            <a href="#none" class="btn_lyr_close">취소</a>
        </div>
    </div>
</div>
<!-- //QA 대상 지정상태 저장 -->

<!-- script -->
<script type="text/javascript">
$(document).ready(function(){
    // 공통 레이어 팝업
	$('.btn_lyr_open').on('click',function(){
        var popHref = $(this).attr('href');

        // popup open
        $('body').addClass('lyr_bg_dim');
        $(popHref).css({'display': 'block'});

        // popup close
        $('.btn_lyr_close, .lyr_bg_dimmed').on('click',function(){
            $('body').removeClass('lyr_bg_dim');
            $('.lyrBox').css({'display': 'none'});
        });
    });

    // 공통 저장완료 레이어 팝업
    $('.btn_lyr_save').on('click',function(){
        var thisLayer = $(this).parents('.lyrBox').attr('id');
        var thisLayerHref = $('#' + thisLayer);
        $(thisLayerHref).css({'display': 'none'});

        $('body').append(' \
            <div class="lyrBox lyr_notify">\
                <div class="lyr_ct"> \
                    <p class="massage">저장 되었습니다.</p> \
                </div> \
            </div> \
        ');
        $('.lyr_notify').show();

        setTimeout(function(){
            $('.lyr_notify').addClass('lyr_hide').delay(300).queue(function(){$(this).remove();});
            $('body').removeClass('lyr_bg_dim');
        }, 600);
    });

    // input:text[numberOnly] 숫자만 입력가능
    $('input:text[numberOnly]').keypress(function(event) {
        if(event.which < 48 || event.which > 57){
            event.preventDefault();
        }
    });

    // QA 대상 지정 총 건수 자동 합계
    // $('.btnBox .btn_lyr_save').on('click', function(){
    $(document).on('click', function(){
        var caseSum = 0;
        $('.target_setArea .set_condition dt .iptBox input').each(function(){
            caseSum += Number($(this).val());
            console.log(caseSum);
            $('.qa_total_case').text(caseSum);
        });
    });
    
    // tree view 메뉴
    var tmrAssignData = [
        {
            id: 1,     // 최초 id 1부터 시작
            pid: '',   // 종속되는 상위 id
            name: '전체선택'
        },
        {
            id: 2, 
            pid: '1',
            name: 'Upsell 1센터'
        },
        {
            id: 8,
            pid: '2',  
            name: '1팀'
        },
        {
            id: 10,
            pid: '8',  
            name: '김민아'
        },
        {
            id: 11,
            pid: '8',  
            name: '이주인'
        }, 
        {
            id: 9,
            pid: '2',
            name: '2팀'
        },
        {
            id: 12,
            pid: '9',  
            name: '홍길동'
        },
        {
            id: 13,
            pid: '9',  
            name: '신정호'
        },
        {
            id: 14,
            pid: '9',  
            name: '이호정'
        },
        {
            id: 3,
            pid: '1',
            name: 'Upsell 2센터'
        },
        {
            id: 4,
            pid: '1',
            name: 'Upsell 3센터'
        },
        {
            id: 5,
            pid: '1',
            name: 'Upsell 4센터'
        },
        {
            id: 6,
            pid: '1',
            name: 'Upsell 5센터'
        },
        {
            id: 7,
            pid: '1',
            name: 'Upsell 4센터'
        },           
    ]
    
    // tree view 호출
    var tree = simTree({
        el: '#tmrAssign',
        data: tmrAssignData,
        check: true,
        linkParent: true
    });
});
</script>
</body>
</html>
